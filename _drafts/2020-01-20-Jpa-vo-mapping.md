---
published: true
layout: single
title: "내가 JPA를 쓰는 이유"
category: Spring
comments: true
---

> ORM을 쓰는 이유는 무엇인가? 순수 SQL을 사용했을 때보다 오버헤드가 있으며, ORM의 구현에 따라 이것저것 설정해야 할 것도 생겨난다. SQL에 익숙하지 않거나 데이터베이스 성능 고려를 하지 않는 사람들이 쓰는것이 아닌가? 

ORM의 장점은 일관된 객체지향적 사고로 시스템을 개발할 수 있다는 것이다. 별로 와닿지 않을 수 있지만 굉장히 큰 장점이라고 생각한다. 또 순수 SQL이나 성능 관련해서도, ORM에 대해 잘못 접근하기 때문에 부작용이 있다고 생각한다.  

시스템을 개발하기 전에 먼저 데이터베이스 스키마를 정해 놓는다. 스키마 대로 시스템을 개발한다. 이런 과정이라면 ORM은 필요 없을지도 모른다. 문장에서도 드러나듯이 데이터베이스에 종속적인 시스템이 만들어지니까 그렇다. 그러나 시스템은 언제나 변경의 가능성이 있다. 이미 배포된 서비스에서 변경이 있을 수 있고, 개발 과정 중에 스펙이 변경될 수도 있다. 스키마를 고쳐가면서 할 것인가? 쉽고 즐거운 일인가? 테스트 할 수 있는가? 고되고 힘들며 테스트하기 어렵다. 개발자는, 사람은, 어렵고 힘든 일을 회피하려 한다. 당연하다. 스키마는 그대로 두고 시스템에서 이리저리 로직을 꼬아가며 변경을 적용한다. 찰나의 시간뒤엔 이미 시스템은 괴물이 되어 있다.

ORM은 **구현** 과정에서 데이터베이스에 대한 생각을 지우게 만든다. 즉 변경이 쉽고 테스트가 쉬워진다. 자바 오브젝트를 리팩토링하는 것과 연동해서 데이터베이스도 **리팩토링** 이 가능하다. (물론 서비스중인 시스템에 대해서는 다른 고려가 필요하다.) 로직에 집중하고 설계에 집중할 수 있다. 풍부한 테스트와 함께 견고한 시스템을 만드는데 중요한 실마리를 제공해 줄 수 있다.

간단하게 엔터티를 리팩토링하는 과정을 보자.

```java
@Entity
public class Book {

    @Id
    @GeneratedValue(strategy = GenerateStrategy.IDENTITY)
    private Long id;

    private Integer isbn;
    private String title;
    private String authorName;
    private BigDecimal price;
    private Integer pages;
    



}